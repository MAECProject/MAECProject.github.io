<?xml version="1.0" encoding="UTF-8"?>
<!--
 MAEC Related Malware
 -Demonstrates how multi-partite malware may be captured as unique Malware Subjects in a Package
 -Shows how the relationships between the multiple related Malware Subjects are constructed
 -Based on SANS Reading Room Paper: A Detailed Analysis of an Advanced Persistent Threat Malware, by Frankie Li. http://www.sans.org/reading_room/whitepapers/malicious/detailed-analysis-advanced-persistent-threat-malware_33814
 -->
<maecPackage:MAEC_Package
 xmlns:maecPackage="http://maec.mitre.org/XMLSchema/maec-package-2"
 xmlns:maecBundle="http://maec.mitre.org/XMLSchema/maec-bundle-4"
 xmlns:maecVocabs="http://maec.mitre.org/default_vocabularies-1"
 xmlns:cybox="http://cybox.mitre.org/cybox-2"
 xmlns:cyboxCommon="http://cybox.mitre.org/common-2"
 xmlns:cyboxVocabs="http://cybox.mitre.org/default_vocabularies-2"
 xmlns:FileObj="http://cybox.mitre.org/objects#FileObject-2"
 xmlns:WinExecFileObj="http://cybox.mitre.org/objects#WinExecutableFileObject-2"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xmlns:example="example.com"
 xsi:schemaLocation="http://maec.mitre.org/XMLSchema/maec-package-2 http://maec.mitre.org/language/version4.1/maec_package_schema.xsd
 http://maec.mitre.org/default_vocabularies-1 http://maec.mitre.org/language/version4.1/maec_default_vocabularies.xsd
 http://cybox.mitre.org/default_vocabularies-2 http://cybox.mitre.org/XMLSchema/default_vocabularies/2.1/cybox_default_vocabularies.xsd
 http://cybox.mitre.org/objects#WinExecutableFileObject http://cybox.mitre.org/XMLSchema/objects/Win_Executable_File/2.1/Win_Executable_File_Object.xsd" 
 id="example:package-e05d8112-4210-4367-b9ed-8370acdee129" schema_version="2.1">

 <maecPackage:Malware_Subjects>
  <maecPackage:Malware_Subject id="example:malware_subject-320e597e-3c62-48da-9fd5-e6bd0c47a094">
   <maecPackage:Malware_Instance_Object_Attributes>
     <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
      <FileObj:File_Name>dg003_improve_8080_V132.exe</FileObj:File_Name>
      <FileObj:Size_In_Bytes>196608</FileObj:Size_In_Bytes>
      <FileObj:Hashes>
       <cyboxCommon:Hash>
        <cyboxCommon:Type xsi:type="cyboxVocabs:HashNameVocab-1.0">MD5</cyboxCommon:Type>
        <cyboxCommon:Simple_Hash_Value>4EC0027BEF4D7E1786A04D021FA8A67F</cyboxCommon:Simple_Hash_Value>
       </cyboxCommon:Hash>
      </FileObj:Hashes>
     </cybox:Properties>
   </maecPackage:Malware_Instance_Object_Attributes>
   
   <maecPackage:Relationships>
    <maecPackage:Relationship>
     <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.0">drops</maecPackage:Type>
     <maecPackage:Malware_Subject_Reference malware_subject_idref="example:malware_subject-75ebd4ad-dd94-4e67-8fdb-8f1630d736ec"/>
    </maecPackage:Relationship>
   </maecPackage:Relationships>
  </maecPackage:Malware_Subject>
  
  <maecPackage:Malware_Subject id="example:malware_subject-75ebd4ad-dd94-4e67-8fdb-8f1630d736ec">
   <maecPackage:Malware_Instance_Object_Attributes>
    <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
     <FileObj:File_Name>msvcr.dll</FileObj:File_Name>
    </cybox:Properties>
   </maecPackage:Malware_Instance_Object_Attributes>
   
   <maecPackage:Relationships>
    <maecPackage:Relationship>
     <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.0">dropped by</maecPackage:Type>
     <maecPackage:Malware_Subject_Reference malware_subject_idref="example:malware_subject-320e597e-3c62-48da-9fd5-e6bd0c47a094"/>
    </maecPackage:Relationship>
    <maecPackage:Relationship>
     <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.0">downloads</maecPackage:Type>
     <maecPackage:Malware_Subject_Reference malware_subject_idref="example:malware_subject-bf2bd2f3-144d-4ff8-b4b8-5f7c264d46d7"/>
     <maecPackage:Malware_Subject_Reference malware_subject_idref="example:malware_subject-99edffb2-b7f3-41c4-adec-ab965914396d"/>
    </maecPackage:Relationship>
   </maecPackage:Relationships>
  </maecPackage:Malware_Subject>
  
  <maecPackage:Malware_Subject id="example:malware_subject-bf2bd2f3-144d-4ff8-b4b8-5f7c264d46d7">
   <maecPackage:Malware_Instance_Object_Attributes>
    <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
     <FileObj:File_Name>fvcwin32.exe</FileObj:File_Name>
    </cybox:Properties>
   </maecPackage:Malware_Instance_Object_Attributes>
   <maecPackage:Relationships>
    <maecPackage:Relationship>
     <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.0">downloaded by</maecPackage:Type>
     <maecPackage:Malware_Subject_Reference malware_subject_idref="example:malware_subject-75ebd4ad-dd94-4e67-8fdb-8f1630d736ec"/>
    </maecPackage:Relationship>
   </maecPackage:Relationships>
  </maecPackage:Malware_Subject>
  
  <maecPackage:Malware_Subject id="example:malware_subject-99edffb2-b7f3-41c4-adec-ab965914396d">
   <maecPackage:Malware_Instance_Object_Attributes>
    <cybox:Properties xsi:type="WinExecFileObj:WindowsExecutableFileObjectType">
     <FileObj:File_Name>acvcwin32.exe</FileObj:File_Name>
    </cybox:Properties>
   </maecPackage:Malware_Instance_Object_Attributes>
   <maecPackage:Relationships>
    <maecPackage:Relationship>
     <maecPackage:Type xsi:type="maecVocabs:MalwareSubjectRelationshipTypeVocab-1.0">downloaded by</maecPackage:Type>
     <maecPackage:Malware_Subject_Reference malware_subject_idref="example:malware_subject-75ebd4ad-dd94-4e67-8fdb-8f1630d736ec"/>
    </maecPackage:Relationship>
   </maecPackage:Relationships>
  </maecPackage:Malware_Subject>
 </maecPackage:Malware_Subjects>
 
 <maecPackage:Grouping_Relationships>
  <maecPackage:Grouping_Relationship>
   <maecPackage:Type xsi:type="maecVocabs:GroupingRelationshipTypeVocab-1.0">observed together</maecPackage:Type>
  </maecPackage:Grouping_Relationship>
 </maecPackage:Grouping_Relationships>
</maecPackage:MAEC_Package>
